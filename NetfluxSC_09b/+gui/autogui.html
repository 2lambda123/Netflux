<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of autogui</title>
  <meta name="keywords" content="autogui">
  <meta name="description" content="gui.autogui">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">NetfluxSC_09b</a> &gt; <a href="index.html">+gui</a> &gt; autogui.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for NetfluxSC_09b\+gui&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>autogui
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>gui.autogui</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> gui.autogui
    g = gui.autogui() creates a figure with a &quot;gui area&quot; and a
    &quot;plotting area&quot;.

    g = gui.autogui(property1, value1, property2, value2,...)
    initializes the autogui with the specified property
    values.

  * The GUI area: When a new widget is created, by default it
    adds itself to the current autogui and is displayed in
    the gui area. Widgets are added top to bottom, left to
    right.
     g.addPanel()  makes room for a new panel or column of widgets
     g.PanelWidth  controls the width of the current panel
     g.Location    controls the location of the gui area
                   relative to the plotting area

  * The plotting area: Normal drawing and axes commands (e.g.,
    GCA, PLOT, SUBPLOT) can be used in the plotting area; no
    special syntax is needed.

  * User input: The autogui can monitor the widgets for user
    input.
     g.monitor(w1,w2,..)  monitors the specified list of widgets
     g.waitForInput()     waits for user input in the monitored widgets
     g.LastInput          returns the widget with most-recent input

  Sample usage:
    g = gui.autogui;
    w1 = gui.numericmenu('Sampling rate (Hz)', [5000 8192 11025 22050 44100]);
    w2 = gui.slider('Prefiltering', [0 1]);
    g.addPanel;
    w3 = gui.editnumber('Sinusoid frequency (Hz)');
    w4 = gui.textmenu('Window', {'Hamming', 'Rectangular'});

    subplot(211);
    subplot(212);

    while g.waitForInput()
       disp(g.LastInput.Value);
       subplot(211); plot(rand(1,100));
       subplot(212); plot(randn(1,100));
    end</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="autogui.html" class="code" title="">autogui</a>	gui.autogui</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="autogui.html" class="code" title="">autogui</a>	gui.autogui</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function obj = autogui(varargin)</a></li><li><a href="#_sub2" class="code">function delete(obj)</a></li><li><a href="#_sub3" class="code">function disp(obj)</a></li><li><a href="#_sub4" class="code">function set.Name(obj,str)</a></li><li><a href="#_sub5" class="code">function out = get.Name(obj)</a></li><li><a href="#_sub6" class="code">function set.Visible(obj,makeVisible)</a></li><li><a href="#_sub7" class="code">function out = get.Visible(obj)</a></li><li><a href="#_sub8" class="code">function out = get.Children(obj)</a></li><li><a href="#_sub9" class="code">function set.PanelWidth(obj, requestedWidth)</a></li><li><a href="#_sub10" class="code">function set.Location(obj, newLocation)</a></li><li><a href="#_sub11" class="code">function set.Position(obj, s)</a></li><li><a href="#_sub12" class="code">function s = get.Position(obj)</a></li><li><a href="#_sub13" class="code">function set.Resizeable(obj, makeResizeable)</a></li><li><a href="#_sub14" class="code">function out = get.Resizeable(obj)</a></li><li><a href="#_sub15" class="code">function set.Exclusive(obj, makeExclusive)</a></li><li><a href="#_sub16" class="code">function out = get.Exclusive(obj)</a></li><li><a href="#_sub17" class="code">function set.Fontsize(obj, fsize)</a></li><li><a href="#_sub18" class="code">function set.ValueChangedFcn(obj, f)</a></li><li><a href="#_sub19" class="code">function f = get.ValueChangedFcn(obj)</a></li><li><a href="#_sub20" class="code">function addPanel(obj)</a></li><li><a href="#_sub21" class="code">function addChild(obj, child)</a></li><li><a href="#_sub22" class="code">function removeChild(obj, child)</a></li><li><a href="#_sub23" class="code">function monitor(obj, varargin)</a></li><li><a href="#_sub24" class="code">function allOk = waitForInput(obj)</a></li><li><a href="#_sub25" class="code">function out = getDebugInfo(obj)</a></li><li><a href="#_sub26" class="code">function axesCreated(obj, hAxes)</a></li><li><a href="#_sub27" class="code">function updateBackgroundColor(obj)</a></li><li><a href="#_sub28" class="code">function updateChildVisibility(obj, child)</a></li><li><a href="#_sub29" class="code">function updateMonitor(obj, varargin)</a></li><li><a href="#_sub30" class="code">function indices = findChildrenInPanel(obj, panelNum)</a></li><li><a href="#_sub31" class="code">function index = findChild(obj, child)</a></li><li><a href="#_sub32" class="code">function createPlotArea(obj, newLocation, doResizeFigure)</a></li><li><a href="#_sub33" class="code">function deletePlotArea(obj)</a></li><li><a href="#_sub34" class="code">function changeGuiAreaWidth(obj, delta)</a></li><li><a href="#_sub35" class="code">function checkChildWidth(obj, child, index)</a></li><li><a href="#_sub36" class="code">function updatePanelHeight(obj, child, index, forceRecompute)</a></li><li><a href="#_sub37" class="code">function finalwidth = updatePanelWidth(obj, oldwidth, newwidth)</a></li><li><a href="#_sub38" class="code">function obj = getCurrentInstance()</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% gui.autogui</span>
0002 <span class="comment">%    g = gui.autogui() creates a figure with a &quot;gui area&quot; and a</span>
0003 <span class="comment">%    &quot;plotting area&quot;.</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%    g = gui.autogui(property1, value1, property2, value2,...)</span>
0006 <span class="comment">%    initializes the autogui with the specified property</span>
0007 <span class="comment">%    values.</span>
0008 <span class="comment">%</span>
0009 <span class="comment">%  * The GUI area: When a new widget is created, by default it</span>
0010 <span class="comment">%    adds itself to the current autogui and is displayed in</span>
0011 <span class="comment">%    the gui area. Widgets are added top to bottom, left to</span>
0012 <span class="comment">%    right.</span>
0013 <span class="comment">%     g.addPanel()  makes room for a new panel or column of widgets</span>
0014 <span class="comment">%     g.PanelWidth  controls the width of the current panel</span>
0015 <span class="comment">%     g.Location    controls the location of the gui area</span>
0016 <span class="comment">%                   relative to the plotting area</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%  * The plotting area: Normal drawing and axes commands (e.g.,</span>
0019 <span class="comment">%    GCA, PLOT, SUBPLOT) can be used in the plotting area; no</span>
0020 <span class="comment">%    special syntax is needed.</span>
0021 <span class="comment">%</span>
0022 <span class="comment">%  * User input: The autogui can monitor the widgets for user</span>
0023 <span class="comment">%    input.</span>
0024 <span class="comment">%     g.monitor(w1,w2,..)  monitors the specified list of widgets</span>
0025 <span class="comment">%     g.waitForInput()     waits for user input in the monitored widgets</span>
0026 <span class="comment">%     g.LastInput          returns the widget with most-recent input</span>
0027 <span class="comment">%</span>
0028 <span class="comment">%  Sample usage:</span>
0029 <span class="comment">%    g = gui.autogui;</span>
0030 <span class="comment">%    w1 = gui.numericmenu('Sampling rate (Hz)', [5000 8192 11025 22050 44100]);</span>
0031 <span class="comment">%    w2 = gui.slider('Prefiltering', [0 1]);</span>
0032 <span class="comment">%    g.addPanel;</span>
0033 <span class="comment">%    w3 = gui.editnumber('Sinusoid frequency (Hz)');</span>
0034 <span class="comment">%    w4 = gui.textmenu('Window', {'Hamming', 'Rectangular'});</span>
0035 <span class="comment">%</span>
0036 <span class="comment">%    subplot(211);</span>
0037 <span class="comment">%    subplot(212);</span>
0038 <span class="comment">%</span>
0039 <span class="comment">%    while g.waitForInput()</span>
0040 <span class="comment">%       disp(g.LastInput.Value);</span>
0041 <span class="comment">%       subplot(211); plot(rand(1,100));</span>
0042 <span class="comment">%       subplot(212); plot(randn(1,100));</span>
0043 <span class="comment">%    end</span>
0044 
0045 <span class="comment">%   Copyright 2009 The MathWorks, Inc.</span>
0046 
0047 classdef (Sealed) <a href="autogui.html" class="code" title="">autogui</a> &lt; gui.container
0048 
0049     properties
0050         <span class="comment">% Name</span>
0051         <span class="comment">%   A string indicating the name of the gui. This string</span>
0052         <span class="comment">%   is used as the name of the figure window.</span>
0053         <span class="comment">%</span>
0054         <span class="comment">%   Sample usage:</span>
0055         <span class="comment">%    g = gui.autogui;</span>
0056         <span class="comment">%    g.Name = 'Filter GUI';</span>
0057         Name
0058     <span class="keyword">end</span>
0059     
0060     properties(GetAccess=public, SetAccess=private)
0061         <span class="comment">% Children</span>
0062         <span class="comment">%   A cell array of widgets in the gui. This property is</span>
0063         <span class="comment">%   read-only.</span>
0064         Children
0065     <span class="keyword">end</span>
0066         
0067     properties
0068         <span class="comment">% PanelWidth</span>
0069         <span class="comment">%   The width (in pixels) of the current gui panel.</span>
0070         <span class="comment">%</span>
0071         <span class="comment">%   Sample usage:</span>
0072         <span class="comment">%    g = gui.autogui;</span>
0073         <span class="comment">%    g.PanelWidth = 120; % make the current panel very narrow</span>
0074         <span class="comment">%    w1 = gui.editnumber('Enter a number');</span>
0075         <span class="comment">%    w2 = gui.slider('My slider');</span>
0076         <span class="comment">%    g.addPanel; % add a new panel</span>
0077         <span class="comment">%    g.PanelWidth = 250; % make the current panel very wide</span>
0078         <span class="comment">%    w3 = gui.slider('Another slider');</span>
0079         PanelWidth = 200
0080         
0081         <span class="comment">% Location</span>
0082         <span class="comment">%   A string indicating the location of the gui area relative</span>
0083         <span class="comment">%   to the axes. Possible values are:</span>
0084         <span class="comment">%     'left'  : The gui area is to the left of the axes</span>
0085         <span class="comment">%     'right' : The gui area is to the right of the axes</span>
0086         <span class="comment">%     'float' : Only the gui area is shown; the axes are not</span>
0087         <span class="comment">%               displayed.</span>
0088         <span class="comment">%</span>
0089         <span class="comment">%   Sample usage:</span>
0090         <span class="comment">%    g = gui.autogui;</span>
0091         <span class="comment">%    g.PanelWidth = 120; % make the current panel very narrow</span>
0092         <span class="comment">%    w1 = gui.editnumber('Enter a number');</span>
0093         <span class="comment">%    w2 = gui.slider('My slider');</span>
0094         <span class="comment">%    g.Location = 'right';</span>
0095         <span class="comment">%    g.Location = 'float';</span>
0096         Location = <span class="string">'left'</span>
0097 
0098         <span class="comment">% Fontsize</span>
0099         <span class="comment">%   The default fontsize to be used for new widgets in the gui (it</span>
0100         <span class="comment">%   will have no effect on previously added widgets).</span>
0101         Fontsize 
0102     <span class="keyword">end</span>
0103     
0104     properties(Dependent)
0105         <span class="comment">% Visible</span>
0106         <span class="comment">%   A boolean indicating whether the gui figure window should be</span>
0107         <span class="comment">%   visible or not.</span>
0108         <span class="comment">%    true  =&gt; gui figure window is visible  (default)</span>
0109         <span class="comment">%    false =&gt; gui figure window is invisible or hidden.</span>
0110         Visible
0111 
0112         <span class="comment">% Position</span>
0113         <span class="comment">%   The position of the gui figure window on the screen. Position</span>
0114         <span class="comment">%   is a struct with the following fields:</span>
0115         <span class="comment">%     x, y  : the coordinates for the lower-left corner of the figure</span>
0116         <span class="comment">%     width : the width of the figure window</span>
0117         <span class="comment">%     height: the height of the figure window</span>
0118         <span class="comment">%</span>
0119         <span class="comment">%   Sample usage:</span>
0120         <span class="comment">%      g = gui.autogui;</span>
0121         <span class="comment">%</span>
0122         <span class="comment">%      % Retrieving the position</span>
0123         <span class="comment">%      g.Position</span>
0124         <span class="comment">%      g.Position.height</span>
0125         <span class="comment">%</span>
0126         <span class="comment">%      % Modifying the position</span>
0127         <span class="comment">%      g.Position.height = 200;</span>
0128         <span class="comment">%      g.Position = struct('width', 200, 'height', 300);</span>
0129         <span class="comment">%</span>
0130         <span class="comment">%      p = g.Position;</span>
0131         <span class="comment">%      p.width = 200;</span>
0132         <span class="comment">%      p.height = 300;</span>
0133         <span class="comment">%      g.Position = p;</span>
0134         Position
0135         
0136         <span class="comment">% Resizeable</span>
0137         <span class="comment">%   A boolean indicating whether the gui figure window can be</span>
0138         <span class="comment">%   resized using the mouse.</span>
0139         <span class="comment">%    true  =&gt; gui figure window can be resized using the mouse</span>
0140         <span class="comment">%            (default)</span>
0141         <span class="comment">%    false =&gt; gui figure window cannot be resized using the mouse.</span>
0142         <span class="comment">%             However, the Position property can still be used</span>
0143         <span class="comment">%             to change the gui figure window size.</span>
0144         Resizeable
0145         
0146         <span class="comment">% Exclusive</span>
0147         <span class="comment">%   A boolean indicating whether the gui figure window is 'modal'</span>
0148         <span class="comment">%   i.e., overrides all other windows and dialog boxes and forces</span>
0149         <span class="comment">%   the user to respond.</span>
0150         <span class="comment">%    true  =&gt; gui figure window is Exclusive</span>
0151         <span class="comment">%    false =&gt; gui figure window is not Exclusive (default).</span>
0152         Exclusive 
0153         
0154         <span class="comment">% ValueChangedFcn</span>
0155         <span class="comment">%</span>
0156         <span class="comment">%   ValueChangedFcn specifies an optional function handle. This</span>
0157         <span class="comment">%   function is invoked if the Value property changes in any widget</span>
0158         <span class="comment">%   in a set of widgets. The set of widgets may be specified by a</span>
0159         <span class="comment">%   prior call to MONITOR. By default, the set is all the widgets</span>
0160         <span class="comment">%   currently in the gui.</span>
0161         <span class="comment">%</span>
0162         <span class="comment">%   The ValueChangedFcn will be invoked  with one input argument</span>
0163         <span class="comment">%   (the handle to the widget).</span>
0164         <span class="comment">%</span>
0165         <span class="comment">%   To disable ValueChangedFcn, set it to [].</span>
0166         <span class="comment">%</span>
0167         <span class="comment">%   Sample usage:</span>
0168         <span class="comment">%    myGui = gui.autogui;</span>
0169         <span class="comment">%    w1 = gui.slider('My slider', [1 100]);</span>
0170         <span class="comment">%    w2 = gui.textmenu('My menu', {'red', 'blue', 'green'});</span>
0171         <span class="comment">%    myGui.ValueChangedFcn = @(h) disp(h.Value);</span>
0172         <span class="comment">%    % now try changing the slider value</span>
0173         <span class="comment">%    myGui.ValueChangedFcn = []; % disable it</span>
0174         <span class="comment">%</span>
0175         <span class="comment">%    myGui.ValueChangedFcn = @myFunction;</span>
0176         <span class="comment">%</span>
0177         <span class="comment">%   Also see:</span>
0178         <span class="comment">%    &lt;a href=&quot;matlab:help gui.autogui.monitor&quot;&gt;monitor&lt;/a&gt; (method)</span>
0179         <span class="comment">%    &lt;a href=&quot;matlab:help gui.autogui.waitForInput&quot;&gt;waitForInput&lt;/a&gt; (method)</span>
0180         ValueChangedFcn        
0181     <span class="keyword">end</span>
0182     
0183     properties(GetAccess=public, SetAccess=private)
0184         <span class="comment">% LastInput</span>
0185         <span class="comment">%   A handle to a widget, used in conjunction with the</span>
0186         <span class="comment">%   waitForInput() method. When waitForInput() returns</span>
0187         <span class="comment">%   successfully, the LastInput property indicates the</span>
0188         <span class="comment">%   widget with the most-recent input activity.</span>
0189         <span class="comment">%</span>
0190         <span class="comment">%    Also see:</span>
0191         <span class="comment">%    &lt;a href=&quot;matlab:help gui.autogui.ValueChangedFcn&quot;&gt;ValueChangedFcn&lt;/a&gt; (property)</span>
0192         <span class="comment">%    &lt;a href=&quot;matlab:help gui.autogui.monitor&quot;&gt;monitor&lt;/a&gt; (method)</span>
0193         <span class="comment">%    &lt;a href=&quot;matlab:help gui.autogui.waitForInput&quot;&gt;waitForInput&lt;/a&gt; (method)</span>
0194         LastInput
0195     <span class="keyword">end</span>
0196     
0197     properties(Constant, GetAccess=private)
0198         DefaultPlotAreaWidth = 420
0199     <span class="keyword">end</span>
0200     
0201     properties (Access=private)
0202         UiMainContainer
0203         UiPlotArea = []
0204         UiGuiArea = []
0205         UiGuiPanelGroup 
0206         UiCurrentGuiPanel 
0207         
0208         MinimumGuiPanelHeight = 1
0209             
0210         ChildList = struct(<span class="string">'widget'</span>, {}, <span class="string">'storedWidth'</span>,{}, <span class="string">'storedHeight'</span>, {}, <span class="string">'panel'</span>,{})
0211         CurrentPanelNum = 0      
0212         WidgetMonitor = []
0213         WidgetMonitorMode = <span class="string">'auto'</span>
0214     <span class="keyword">end</span>
0215     
0216     methods        
0217         <a name="_sub0" href="#_subfunctions" class="code">function obj = autogui(varargin)            </a>
0218             <span class="keyword">if</span> rem(nargin,2)==1
0219                 throw(MException(<span class="string">'autogui:InvalidParameter'</span>, <span class="keyword">...</span>
0220                     [<span class="string">'Parameters should property-value pairs, e.g.,\n'</span> <span class="keyword">...</span>
0221                      <span class="string">'gui.autogui(''Fontsize'', 10, ''Visible'', false, ...)'</span>]));
0222             <span class="keyword">end</span>            
0223             <span class="comment">% need to start with visible == off to prevent flicker when</span>
0224             <span class="comment">% visibility is turned off later.</span>
0225             hFig = figure(<span class="string">'visible'</span>, <span class="string">'off'</span>);           
0226             obj@gui.container(hFig);
0227             
0228             set(obj.UiHandle, <span class="string">'defaultaxescreatefcn'</span>, @(h,e) <a href="#_sub26" class="code" title="subfunction axesCreated(obj, hAxes)">axesCreated</a>(obj, h));           
0229             
0230             <span class="comment">% prevent reentrant callbacks (e.g. if the computation take a while</span>
0231             <span class="comment">% and a slider button is kept pressed)</span>
0232             set(obj.UiHandle, <span class="string">'defaultuicontrolinterruptible'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
0233                               <span class="string">'defaultuicontrolbusyaction'</span>,<span class="string">'cancel'</span>);
0234 
0235             <span class="comment">% UiHandle</span>
0236             <span class="comment">%   UiMainContainer [uiflowcontainer] - contains guiarea &amp; plotarea</span>
0237             <span class="comment">%      UiPlotArea [uipanel]</span>
0238             <span class="comment">%      UiGuiArea [uipanel]</span>
0239             <span class="comment">%          UiGuiPanelGroup [uiflowcontainer]</span>
0240             <span class="comment">%             UiCurrentGuiPanel [uiflowcontainer]</span>
0241                         
0242             obj.Fontsize = 10; <span class="comment">% default fontsize</span>
0243             
0244             obj.UiMainContainer = gui.util.uiflowcontainer(<span class="string">'parent'</span>, obj.UiHandle, <span class="keyword">...</span>
0245                                             <span class="string">'units'</span>, <span class="string">'normalized'</span>, <span class="keyword">...</span>
0246                                             <span class="string">'position'</span>, [0 0 1 1], <span class="keyword">...</span>
0247                                             <span class="string">'backgroundcolor'</span>, obj.BackgroundColor, <span class="keyword">...</span>
0248                                             <span class="string">'flowdirection'</span>,<span class="string">'lefttoright'</span>, <span class="keyword">...</span>
0249                                             <span class="string">'tag'</span>, <span class="string">'autogui-maincontainer'</span>);
0250 
0251             obj.UiGuiArea = uipanel(<span class="string">'parent'</span>, obj.UiMainContainer, <span class="keyword">...</span>
0252                                     <span class="string">'units'</span>, <span class="string">'pixels'</span>, <span class="keyword">...</span>
0253                                     <span class="string">'backgroundcolor'</span>, obj.BackgroundColor, <span class="keyword">...</span>
0254                                     <span class="string">'tag'</span>, <span class="string">'autogui-guiarea'</span>);
0255 
0256             set(obj.UiGuiArea, <span class="string">'widthlimits'</span>, [1 1], <span class="keyword">...</span>
0257                                <span class="string">'heightlimits'</span>, [2 inf]);
0258                            
0259             obj.UiGuiPanelGroup = gui.util.uiflowcontainer(<span class="string">'parent'</span>, obj.UiGuiArea, <span class="keyword">...</span><span class="comment">      </span>
0260                                                   <span class="string">'units'</span>, <span class="string">'pixels'</span>, <span class="keyword">...</span>
0261                                                   <span class="string">'backgroundcolor'</span>, obj.BackgroundColor, <span class="keyword">...</span>
0262                                                   <span class="string">'flowdirection'</span>,<span class="string">'lefttoright'</span>, <span class="keyword">...</span>
0263                                                   <span class="string">'tag'</span>, <span class="string">'autogui-guipanelgroup'</span>);
0264                        
0265             obj.addPanel();
0266             set(obj.UiGuiArea, <span class="string">'HeightLimits'</span>, obj.MinimumGuiPanelHeight + [0 0]);  
0267 
0268             <a href="#_sub32" class="code" title="subfunction createPlotArea(obj, newLocation, doResizeFigure)">createPlotArea</a>(obj, obj.Location, false);            
0269                         
0270             addlistener(obj, <span class="string">'BackgroundColor'</span>, <span class="string">'PostSet'</span>, <span class="keyword">...</span>
0271                 @(src,e) <a href="#_sub27" class="code" title="subfunction updateBackgroundColor(obj)">updateBackgroundColor</a>(obj));       
0272             
0273             <span class="keyword">try</span>
0274                 <span class="comment">% apply the parameter list in two phases.</span>
0275                 <span class="comment">% phase 1: stash the params in a struct (this avoids issues</span>
0276                 <span class="comment">% like multiple occurrences of a param -- only the last</span>
0277                 <span class="comment">% occurrence counts).</span>
0278                 cnt = 1;
0279                 tmpStruct = [];
0280                 <span class="keyword">while</span> cnt+1 &lt;= numel(varargin)
0281                     param = varargin{cnt};
0282                     val = varargin{cnt+1}; 
0283                     tmpStruct.(param) = val;
0284                     cnt=cnt+2;
0285                 <span class="keyword">end</span>
0286                 <span class="comment">% ensure visibility by default, unless explicitly turned off</span>
0287                 <span class="keyword">if</span> ~isfield(tmpStruct, <span class="string">'Visible'</span>)
0288                     tmpStruct.Visible = true;
0289                 <span class="keyword">end</span>
0290                 <span class="comment">% phase 2: apply the struct params to the object</span>
0291                 fn = fieldnames(tmpStruct).';
0292                 <span class="keyword">for</span> f=fn
0293                     obj.(f{1}) = tmpStruct.(f{1});
0294                 <span class="keyword">end</span>                
0295             <span class="keyword">catch</span> ME
0296                 <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(obj.UiHandle);
0297                 throw(MException(<span class="string">'autogui:InvalidParameter'</span>, [<span class="string">'Unable to create autogui\n'</span> ME.message]));
0298             <span class="keyword">end</span>
0299         <span class="keyword">end</span>
0300                 
0301         <a name="_sub1" href="#_subfunctions" class="code">function delete(obj)</a>
0302             <span class="comment">% As widgets get deleted, obj.ChildWidgets can change under us</span>
0303             <span class="comment">% so use a temporary list for looping</span>
0304             tempChildWidgets = obj.Children;            
0305             <span class="keyword">for</span> i=1:numel(tempChildWidgets)
0306                 <a href="#_sub22" class="code" title="subfunction removeChild(obj, child)">removeChild</a>(obj, tempChildWidgets{i});
0307             <span class="keyword">end</span>
0308             <span class="comment">% No need to delete obj.UiMainContainer, etc.; these will</span>
0309             <span class="comment">% be cleaned up by the figure deletion.</span>
0310         <span class="keyword">end</span>
0311         
0312         <a name="_sub2" href="#_subfunctions" class="code">function disp(obj)</a>
0313             gui.util.showObjectInfo.properties(obj);
0314         <span class="keyword">end</span>
0315     <span class="keyword">end</span> 
0316     
0317     <span class="comment">% get/set methods</span>
0318     methods
0319         <a name="_sub3" href="#_subfunctions" class="code">function set.Name(obj,str)            </a>
0320             set(obj.UiHandle,<span class="string">'name'</span>,str);
0321         <span class="keyword">end</span>
0322         
0323         <a name="_sub4" href="#_subfunctions" class="code">function out = get.Name(obj)</a>
0324             out = get(obj.UiHandle,<span class="string">'name'</span>);
0325         <span class="keyword">end</span>
0326         
0327         <a name="_sub5" href="#_subfunctions" class="code">function set.Visible(obj,makeVisible)</a>
0328             <span class="keyword">if</span> ~(isscalar(makeVisible) &amp;&amp; (islogical(makeVisible) || isnumeric(makeVisible)))
0329                 throw(MException(<span class="string">'autogui:InvalidVisible'</span>, <span class="string">'Visible should be true or false'</span>));
0330             <span class="keyword">end</span>
0331             <span class="keyword">if</span> makeVisible
0332                 set(obj.UiHandle, <span class="string">'Visible'</span>, <span class="string">'on'</span>);
0333             <span class="keyword">else</span>
0334                 set(obj.UiHandle, <span class="string">'Visible'</span>, <span class="string">'off'</span>);
0335             <span class="keyword">end</span>            
0336         <span class="keyword">end</span>
0337         
0338         <a name="_sub6" href="#_subfunctions" class="code">function out = get.Visible(obj)</a>
0339             out = strcmp(get(obj.UiHandle,<span class="string">'Visible'</span>), <span class="string">'on'</span>);
0340         <span class="keyword">end</span>
0341         
0342         <a name="_sub7" href="#_subfunctions" class="code">function out = get.Children(obj)</a>
0343             out = {obj.ChildList.widget};
0344         <span class="keyword">end</span>
0345         
0346         <a name="_sub8" href="#_subfunctions" class="code">function set.PanelWidth(obj, requestedWidth)</a>
0347             w = <a href="#_sub37" class="code" title="subfunction finalwidth = updatePanelWidth(obj, oldwidth, newwidth)">updatePanelWidth</a>(obj, obj.PanelWidth, requestedWidth);
0348             <span class="keyword">if</span> w ~= requestedWidth
0349                 warning(<span class="string">'autogui:PanelWidthAdjustment'</span>, <span class="keyword">...</span>
0350                     [<span class="string">'Some widgets cannot support width of %d pixels,\n'</span> <span class="keyword">...</span>
0351                     <span class="string">'so the panel width is set to %d pixels'</span>], <span class="keyword">...</span>
0352                     requestedWidth, w);
0353             <span class="keyword">end</span>            
0354             set(obj.UiCurrentGuiPanel,  <span class="string">'widthlimits'</span>, [w w]);
0355             <a href="#_sub34" class="code" title="subfunction changeGuiAreaWidth(obj, delta)">changeGuiAreaWidth</a>(obj, w - obj.PanelWidth);
0356             refresh(obj.UiHandle);
0357             obj.PanelWidth = w;
0358         <span class="keyword">end</span>
0359         
0360         
0361         <a name="_sub9" href="#_subfunctions" class="code">function set.Location(obj, newLocation)</a>
0362             str = [obj.Location <span class="string">'-&gt;'</span> newLocation];
0363             <span class="keyword">switch</span> str
0364                 <span class="keyword">case</span> {<span class="string">'left-&gt;left'</span>, <span class="string">'right-&gt;right'</span>, <span class="string">'float-&gt;float'</span>}
0365                     <span class="comment">% nothing to do</span>
0366                 <span class="keyword">case</span> <span class="string">'right-&gt;left'</span>
0367                     set(obj.UiMainContainer, <span class="string">'flowdirection'</span>, <span class="string">'lefttoright'</span>);
0368                 <span class="keyword">case</span> <span class="string">'left-&gt;right'</span>
0369                     set(obj.UiMainContainer, <span class="string">'flowdirection'</span>, <span class="string">'righttoleft'</span>);
0370                 <span class="keyword">case</span> {<span class="string">'float-&gt;left'</span>, <span class="string">'float-&gt;right'</span>}
0371                     <a href="#_sub32" class="code" title="subfunction createPlotArea(obj, newLocation, doResizeFigure)">createPlotArea</a>(obj, newLocation, true);
0372                 <span class="keyword">case</span> {<span class="string">'left-&gt;float'</span>, <span class="string">'right-&gt;float'</span>}
0373                      <a href="#_sub33" class="code" title="subfunction deletePlotArea(obj)">deletePlotArea</a>(obj);
0374                 <span class="keyword">otherwise</span>
0375                     throw(MException(<span class="string">'autogui:InvalidLocation'</span>, <span class="keyword">...</span>
0376                         <span class="string">'Location should be ''left'', ''right'' or ''float'''</span>));
0377             <span class="keyword">end</span>
0378             obj.Location = newLocation;
0379             refresh(obj.UiHandle);
0380         <span class="keyword">end</span>
0381         
0382         <a name="_sub10" href="#_subfunctions" class="code">function set.Position(obj, s)           </a>
0383             pos = gui.util.uiposition.structToVec(s);         
0384             <span class="comment">% pos is [x y w h]</span>
0385             <span class="comment">% Unspecified fields have a value of nan in pos.</span>
0386             curpos = get(obj.UiHandle, <span class="string">'position'</span>);
0387             indices = isnan(pos);
0388             pos(indices) = curpos(indices);
0389             set(obj.UiHandle,<span class="string">'position'</span>, pos);
0390         <span class="keyword">end</span>
0391         
0392         <a name="_sub11" href="#_subfunctions" class="code">function s = get.Position(obj)</a>
0393             p = get(obj.UiHandle, <span class="string">'position'</span>);
0394             s = struct(<span class="string">'x'</span>, p(1), <span class="string">'y'</span>, p(2), <span class="string">'width'</span>, p(3), <span class="string">'height'</span>, p(4));
0395         <span class="keyword">end</span>
0396 
0397         <a name="_sub12" href="#_subfunctions" class="code">function set.Resizeable(obj, makeResizeable)</a>
0398             <span class="keyword">if</span> makeResizeable
0399                 str = <span class="string">'on'</span>;
0400             <span class="keyword">else</span>
0401                 str = <span class="string">'off'</span>;
0402             <span class="keyword">end</span>
0403             set(obj.UiHandle, <span class="string">'Resize'</span>, str);            
0404         <span class="keyword">end</span>
0405         
0406         <a name="_sub13" href="#_subfunctions" class="code">function out = get.Resizeable(obj)</a>
0407             out = strcmp(get(obj.UiHandle,<span class="string">'Resize'</span>),<span class="string">'on'</span>);            
0408         <span class="keyword">end</span>
0409         
0410         <a name="_sub14" href="#_subfunctions" class="code">function set.Exclusive(obj, makeExclusive)</a>
0411             <span class="keyword">if</span> makeExclusive
0412                 str = <span class="string">'modal'</span>;
0413             <span class="keyword">else</span>
0414                 str = <span class="string">'normal'</span>;
0415             <span class="keyword">end</span>
0416             set(obj.UiHandle, <span class="string">'WindowStyle'</span>, str);                        
0417         <span class="keyword">end</span>
0418         
0419         <a name="_sub15" href="#_subfunctions" class="code">function out = get.Exclusive(obj)</a>
0420             out = strcmp(get(obj.UiHandle, <span class="string">'WindowStyle'</span>), <span class="string">'modal'</span>);
0421         <span class="keyword">end</span>
0422         
0423         <a name="_sub16" href="#_subfunctions" class="code">function set.Fontsize(obj, fsize)</a>
0424             <span class="keyword">if</span> isscalar(fsize) &amp;&amp; isnumeric(fsize) &amp;&amp; (fsize &gt; 0)
0425                 obj.Fontsize = fsize;
0426                 set(obj.UiHandle, <span class="string">'defaultuicontrolfontsize'</span>, fsize);
0427             <span class="keyword">else</span>
0428                 throw(MException(<span class="string">'autogui:InvalidFontsize'</span>, <span class="string">'Fontsize should be a positive number'</span>));
0429             <span class="keyword">end</span>
0430         <span class="keyword">end</span>
0431         
0432         <a name="_sub17" href="#_subfunctions" class="code">function set.ValueChangedFcn(obj, f)</a>
0433             <span class="keyword">if</span> isempty(obj.WidgetMonitor)
0434                 <span class="keyword">if</span> isempty(obj.Children)
0435                     throw(MException(<span class="string">'autogui:InvalidParameter'</span>, <span class="keyword">...</span>
0436                         <span class="string">'This gui has no widgets to monitor!'</span>));
0437                 <span class="keyword">end</span>
0438                 <a href="#_sub29" class="code" title="subfunction updateMonitor(obj, varargin)">updateMonitor</a>(obj, obj.Children);
0439                 obj.WidgetMonitorMode = <span class="string">'auto'</span>;                
0440             <span class="keyword">end</span>
0441             obj.WidgetMonitor.ValueChangedFcn = f;
0442         <span class="keyword">end</span>
0443         
0444         <a name="_sub18" href="#_subfunctions" class="code">function f = get.ValueChangedFcn(obj)</a>
0445             <span class="keyword">if</span> isempty(obj.WidgetMonitor)
0446                 f = [];
0447             <span class="keyword">else</span>
0448                 f = obj.WidgetMonitor.ValueChangedFcn;
0449             <span class="keyword">end</span>
0450         <span class="keyword">end</span>
0451     <span class="keyword">end</span>
0452     
0453     <span class="comment">% public methods</span>
0454     methods
0455         
0456         <a name="_sub19" href="#_subfunctions" class="code">function addPanel(obj)</a>
0457             <span class="comment">% addPanel          gui.autogui method</span>
0458             <span class="comment">%</span>
0459             <span class="comment">%   obj.addPanel() adds a new vertical panel to the current gui.</span>
0460             <span class="comment">%     Any widgets that are subsequent added to the gui will be</span>
0461             <span class="comment">%     added to the new panel. The width of the current panel may be</span>
0462             <span class="comment">%     adjusted using the PanelWidth property.</span>
0463             <span class="comment">%</span>
0464             <span class="comment">%  Sample usage:</span>
0465             <span class="comment">%   g = gui.autogui;</span>
0466             <span class="comment">%   w1 = gui.edittext('My field 1');;</span>
0467             <span class="comment">%   w2 = gui.edittext('My field 2');</span>
0468             <span class="comment">%   g.addPanel();</span>
0469             <span class="comment">%   g.PanelWidth = 300;</span>
0470             <span class="comment">%   w3 = gui.edittext('My field 3');</span>
0471             <span class="comment">%   w4 = gui.edittext('My field 4');</span>
0472             
0473             obj.UiCurrentGuiPanel = gui.util.uiflowcontainer(<span class="string">'parent'</span>, obj.UiGuiPanelGroup, <span class="keyword">...</span>
0474                                                      <span class="string">'backgroundcolor'</span>, obj.BackgroundColor, <span class="keyword">...</span>
0475                                                      <span class="string">'flowdirection'</span>,<span class="string">'topdown'</span>, <span class="keyword">...</span>
0476                                                      <span class="string">'tag'</span>, <span class="string">'autogui-currentguipanel'</span>);
0477             obj.CurrentPanelNum = obj.CurrentPanelNum + 1;
0478             set(obj.UiCurrentGuiPanel, <span class="string">'widthlimits'</span>, obj.PanelWidth + [0 0]);
0479             obj.changeGuiAreaWidth( obj.PanelWidth + 4 );     
0480             refresh(obj.UiHandle);
0481         <span class="keyword">end</span>   
0482         
0483         
0484         <a name="_sub20" href="#_subfunctions" class="code">function addChild(obj, child)</a>
0485             <span class="comment">% addChild         gui.autogui method</span>
0486             <span class="comment">%</span>
0487             <span class="comment">%   obj.addChild(w) adds the child widget w to the current gui.</span>
0488             <span class="comment">%</span>
0489             <span class="comment">%   There is usually no need to call this function directly; the</span>
0490             <span class="comment">%   child widgets automatically add themselves to the gui.</span>
0491 
0492             <span class="comment">% Note: child construction may not be complete when this function is</span>
0493             <span class="comment">% called</span>
0494             assert(isa(child, <span class="string">'gui.widget'</span>));
0495             <span class="keyword">if</span> ~isempty(obj.findChild(child))
0496                 throwAsCaller(MException(<span class="string">'autogui:InvalidAdd'</span>, <span class="string">'Widget is already a child of the container'</span>));
0497             <span class="keyword">end</span> 
0498             obj.ChildList(end+1) = struct(<span class="string">'widget'</span>, child, <span class="keyword">...</span>
0499                                           <span class="string">'storedWidth'</span>, nan, <span class="keyword">...</span>
0500                                           <span class="string">'storedHeight'</span>, nan, <span class="keyword">...</span>
0501                                           <span class="string">'panel'</span>, obj.CurrentPanelNum);
0502             
0503             child.setUiParent(obj, obj.UiCurrentGuiPanel);
0504             <a href="#_sub28" class="code" title="subfunction updateChildVisibility(obj, child)">updateChildVisibility</a>(obj, child);
0505             
0506             <span class="comment">% listeners will be deleted automatically when child is destroyed</span>
0507             <span class="comment">% Also, listeners have Recursive=false by default.</span>
0508             addlistener(child, <span class="string">'ObjectBeingDestroyed'</span>, @(h,e) <a href="#_sub22" class="code" title="subfunction removeChild(obj, child)">removeChild</a>(obj, h));
0509             addlistener(child, <span class="string">'Visible'</span>, <span class="string">'PostSet'</span>, @(src,e) <a href="#_sub28" class="code" title="subfunction updateChildVisibility(obj, child)">updateChildVisibility</a>(obj,e.AffectedObject));
0510             
0511             <span class="keyword">if</span> ~isempty(obj.WidgetMonitor) &amp;&amp; strcmp(obj.WidgetMonitorMode, <span class="string">'auto'</span>)
0512                 <span class="keyword">try</span>
0513                     <a href="#_sub29" class="code" title="subfunction updateMonitor(obj, varargin)">updateMonitor</a>(obj, obj.Children);
0514                 <span class="keyword">catch</span> ME
0515                     warning(<span class="string">'autogui:addChild'</span>, [<span class="string">'Unable to update monitor\n'</span> ME.message]);
0516                 <span class="keyword">end</span>
0517             <span class="keyword">end</span>
0518         <span class="keyword">end</span>
0519         
0520         
0521         <a name="_sub21" href="#_subfunctions" class="code">function removeChild(obj, child)      </a>
0522             <span class="comment">% removeChild        gui.autogui method</span>
0523             <span class="comment">%</span>
0524             <span class="comment">%   obj.removeChild(w) removes the child widget w to the current</span>
0525             <span class="comment">%     gui and deletes it.</span>
0526             <span class="comment">%</span>
0527             <span class="comment">%   There is usually no need to call this function directly. When a</span>
0528             <span class="comment">%   widget is deleted, it automatically removes itself from the</span>
0529             <span class="comment">%   gui.</span>
0530             assert(isa(child, <span class="string">'gui.widget'</span>));
0531             index = obj.findChild(child);
0532             <span class="keyword">if</span> isempty(index)
0533                 throwAsCaller(MException(<span class="string">'autogui:InvalidAdd'</span>, <span class="string">'Widget is not a child of the container'</span>));
0534             <span class="keyword">end</span> 
0535                         
0536             <span class="keyword">if</span> isvalid(child)
0537                 <span class="comment">% this will invoke removeChild via listener</span>
0538                 <span class="comment">% and will also release all the associated listeners</span>
0539                 <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(child);
0540             <span class="keyword">else</span>
0541                 obj.ChildList(index) = [];
0542             <span class="keyword">end</span>
0543         <span class="keyword">end</span>
0544         
0545         
0546         <a name="_sub22" href="#_subfunctions" class="code">function monitor(obj, varargin)</a>
0547             <span class="comment">% monitor          gui.autogui method</span>
0548             <span class="comment">%   Specify the set of widgets to be monitored by the</span>
0549             <span class="comment">%   waitForInput() and the ValueChangedFcn property</span>
0550             <span class="comment">%</span>
0551             <span class="comment">%   obj.monitor(w1, w2, ..., wn) specifies that the widgets w1,</span>
0552             <span class="comment">%     w2, ... wn should be monitored.</span>
0553             <span class="comment">%</span>
0554             <span class="comment">%   obj.monitor(C) specifies that the widgets in the cell</span>
0555             <span class="comment">%     array C should be monitored.</span>
0556             <span class="comment">%</span>
0557             <span class="comment">%   Sample usage:</span>
0558             <span class="comment">%    g = gui.autogui;</span>
0559             <span class="comment">%    w1 = gui.edittext('Your name');</span>
0560             <span class="comment">%    w2 = gui.slider('Age in years', [1 100]);</span>
0561             <span class="comment">%</span>
0562             <span class="comment">%    g.monitor(w1,w2); % monitor w1,w2</span>
0563             <span class="comment">%    g.monitor(w2);    % monitor only w2</span>
0564             <span class="comment">%    w3 = gui.editnumber('Employee ID');</span>
0565             <span class="comment">%    g.monitor(g.Children); % monitors w1,w2,w3</span>
0566             <span class="comment">%</span>
0567             <span class="comment">%    while g.waitForInput()</span>
0568             <span class="comment">%       disp(g.LastInput.Value);</span>
0569             <span class="comment">%    end</span>
0570             <span class="comment">%</span>
0571             <span class="comment">%    Also see:</span>
0572             <span class="comment">%    &lt;a href=&quot;matlab:help gui.autogui.LastInput&quot;&gt;LastInput&lt;/a&gt; (property)</span>
0573             <span class="comment">%    &lt;a href=&quot;matlab:help gui.autogui.ValueChangedFcn&quot;&gt;ValueChangedFcn&lt;/a&gt; (property)</span>
0574             <span class="comment">%    &lt;a href=&quot;matlab:help gui.autogui.waitForInput&quot;&gt;waitForInput&lt;/a&gt; (method)</span>
0575             
0576             <span class="comment">% updateMonitor will throw if there is a problem</span>
0577             <a href="#_sub29" class="code" title="subfunction updateMonitor(obj, varargin)">updateMonitor</a>(obj, varargin{:});
0578             obj.WidgetMonitorMode = <span class="string">'manual'</span>;
0579         <span class="keyword">end</span>
0580                 
0581         
0582         <a name="_sub23" href="#_subfunctions" class="code">function allOk = waitForInput(obj)</a>
0583             <span class="comment">% waitForInput            gui.autogui method</span>
0584             <span class="comment">%   Waits for any input in a set of widgets. The set of widgets</span>
0585             <span class="comment">%   may be specified by a prior call to MONITOR. By default,</span>
0586             <span class="comment">%   the set is all the widgets currently in the gui.</span>
0587             <span class="comment">%</span>
0588             <span class="comment">%   allOk = obj.waitForInput() waits until there is an input (i.e.,</span>
0589             <span class="comment">%   until the Value property of a widget is modified).</span>
0590             <span class="comment">%</span>
0591             <span class="comment">%    allOk is true =&gt; there was an input, and the corresponding</span>
0592             <span class="comment">%       widget is given by the LastInput property.</span>
0593             <span class="comment">%    allOk is false =&gt; the gui was closed or deleted in the</span>
0594             <span class="comment">%       meantime. The LastInput property is undefined.</span>
0595             <span class="comment">%</span>
0596             <span class="comment">%   Sample usage:</span>
0597             <span class="comment">%    g = gui.autogui;</span>
0598             <span class="comment">%    w1 = gui.edittext('Enter your name');</span>
0599             <span class="comment">%    w2 = gui.slider('Age (in years)');</span>
0600             <span class="comment">%    while g.waitForInput()</span>
0601             <span class="comment">%       disp(g.LastInput.Value);</span>
0602             <span class="comment">%    end</span>
0603             <span class="comment">%</span>
0604             <span class="comment">%    Also see:</span>
0605             <span class="comment">%    &lt;a href=&quot;matlab:help gui.autogui.LastInput&quot;&gt;LastInput&lt;/a&gt; (property)</span>
0606             <span class="comment">%    &lt;a href=&quot;matlab:help gui.autogui.ValueChangedFcn&quot;&gt;ValueChangedFcn&lt;/a&gt; (property)</span>
0607             <span class="comment">%    &lt;a href=&quot;matlab:help gui.autogui.monitor&quot;&gt;monitor&lt;/a&gt; (method)</span>
0608             <span class="keyword">if</span> isempty(obj.WidgetMonitor)
0609                 <span class="keyword">if</span> isempty(obj.Children)
0610                     throw(MException(<span class="string">'autogui:InvalidParameter'</span>, <span class="keyword">...</span>
0611                         <span class="string">'This gui has no widgets to monitor!'</span>));
0612                 <span class="keyword">end</span>                
0613                 <a href="#_sub29" class="code" title="subfunction updateMonitor(obj, varargin)">updateMonitor</a>(obj, obj.Children);
0614                 obj.WidgetMonitorMode = <span class="string">'auto'</span>;                
0615             <span class="keyword">end</span>
0616                         
0617             allOk = obj.WidgetMonitor.waitForInput();
0618             <span class="keyword">if</span> allOk
0619                 obj.LastInput = obj.WidgetMonitor.LastInput;
0620             <span class="keyword">end</span>
0621             
0622             <span class="keyword">if</span> ~allOk &amp;&amp; isvalid(obj)
0623                 obj.LastInput = [];
0624             <span class="keyword">end</span>
0625         <span class="keyword">end</span>
0626     <span class="keyword">end</span>
0627     
0628     <span class="comment">% Methods used in callbacks</span>
0629     methods(Hidden)
0630         <span class="comment">% used for testing</span>
0631         <a name="_sub24" href="#_subfunctions" class="code">function out = getDebugInfo(obj)</a>
0632             out.numPanels = obj.CurrentPanelNum;
0633         <span class="keyword">end</span>
0634         
0635         <a name="_sub25" href="#_subfunctions" class="code">function axesCreated(obj, hAxes)</a>
0636             set(hAxes, <span class="string">'parent'</span>, obj.UiPlotArea);
0637         <span class="keyword">end</span>
0638         
0639         <a name="_sub26" href="#_subfunctions" class="code">function updateBackgroundColor(obj)</a>
0640             col = obj.BackgroundColor;
0641             set([obj.UiMainContainer obj.UiPlotArea obj.UiGuiArea obj.UiGuiPanelGroup], <span class="string">'BackgroundColor'</span>, col);
0642             set(get(obj.UiGuiPanelGroup, <span class="string">'Children'</span>), <span class="string">'BackgroundColor'</span>, col);
0643         <span class="keyword">end</span>
0644         
0645         <a name="_sub27" href="#_subfunctions" class="code">function updateChildVisibility(obj, child)</a>
0646             <span class="keyword">if</span> ~child.Visible
0647                 <span class="keyword">return</span>;
0648             <span class="keyword">end</span>
0649             
0650             index = obj.findChild(child);
0651             <span class="comment">% assert is not JIT-ed</span>
0652             <span class="comment">% assert(~isempty(index));</span>
0653 
0654             <span class="keyword">if</span> isnan(obj.ChildList(index).storedWidth)
0655                 <span class="comment">% widget just added to container,</span>
0656                 <span class="comment">% try to accomodate it to the panel</span>
0657                 child.setPositionWidth(obj.PanelWidth);
0658                 <span class="comment">% if widget can't match obj.PanelWidth, adjust panel instead</span>
0659                 <span class="keyword">if</span> child.getPositionWidth() &gt; obj.PanelWidth
0660                     obj.PanelWidth = child.getPositionWidth();
0661                 <span class="keyword">end</span>
0662                 obj.ChildList(index).storedWidth = child.getPositionWidth();
0663                 obj.ChildList(index).storedHeight = child.getPositionHeight();
0664                 addlistener(child, <span class="string">'PositionChanged'</span>, @(h,e) <a href="#_sub28" class="code" title="subfunction updateChildVisibility(obj, child)">updateChildVisibility</a>(obj,h));  
0665                 
0666                 obj.updatePanelHeight(child, index, true);
0667             <span class="keyword">else</span>                                
0668                 obj.checkChildWidth(child, index);
0669                 obj.updatePanelHeight(child, index, false);
0670             <span class="keyword">end</span>            
0671         <span class="keyword">end</span>
0672         
0673     <span class="keyword">end</span>
0674        
0675    <span class="comment">%% private helper methods</span>
0676    methods (Access=private)
0677 
0678        <span class="comment">% creates a WidgetMonitor (overwrites one if it already exists).</span>
0679        <span class="comment">% In case of error, WidgetMonitor is set to [] and mode to 'auto'</span>
0680         <a name="_sub28" href="#_subfunctions" class="code">function updateMonitor(obj, varargin)</a>
0681             <span class="keyword">if</span> isempty(obj.WidgetMonitor)
0682                  oldValueChangedFcn = [];
0683             <span class="keyword">else</span>
0684                 oldValueChangedFcn = obj.WidgetMonitor.ValueChangedFcn;
0685                 <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(obj.WidgetMonitor);
0686             <span class="keyword">end</span>
0687             
0688             <span class="keyword">try</span>
0689                 obj.WidgetMonitor = gui.monitor(varargin{:});
0690                 obj.WidgetMonitor.Timeout = inf;
0691                 obj.WidgetMonitor.ValueChangedFcn = oldValueChangedFcn;
0692             <span class="keyword">catch</span> ME
0693                 obj.WidgetMonitor = [];
0694                 obj.WidgetMonitorMode = <span class="string">'auto'</span>;
0695                 throwAsCaller(MException(<span class="string">'autogui:monitor'</span>, [<span class="string">'Unable to monitor widgets\n'</span> ME.message]));
0696             <span class="keyword">end</span>
0697             obj.LastInput = [];
0698         <span class="keyword">end</span>
0699        
0700         <a name="_sub29" href="#_subfunctions" class="code">function indices = findChildrenInPanel(obj, panelNum)</a>
0701            <span class="keyword">if</span> ~exist(<span class="string">'panelNum'</span>, <span class="string">'var'</span>), 
0702                panelNum = obj.CurrentPanelNum; 
0703            <span class="keyword">end</span>
0704            <span class="comment">% assert is not JIT-ed</span>
0705            <span class="comment">% assert((panelNum &gt; 0) &amp;&amp; panelNum &lt;= obj.CurrentPanelNum);</span>
0706            indices = find([obj.ChildList.panel] == panelNum);
0707         <span class="keyword">end</span>
0708         
0709        <a name="_sub30" href="#_subfunctions" class="code">function index = findChild(obj, child)           </a>
0710            n = numel(obj.ChildList);
0711            index = [];
0712            <span class="keyword">for</span> i=1:n
0713                <span class="keyword">if</span> (child == obj.ChildList(i).widget)
0714                    index = i; <span class="keyword">break</span>;
0715                <span class="keyword">end</span>
0716            <span class="keyword">end</span>
0717        <span class="keyword">end</span>
0718        
0719         <span class="comment">% does not update obj.Location</span>
0720         <a name="_sub31" href="#_subfunctions" class="code">function createPlotArea(obj, newLocation, doResizeFigure)            </a>
0721             <span class="comment">% add the plotarea  and expand the size of the figure to match</span>
0722             <span class="comment">% assert is not JIT-ed</span>
0723             assert(isempty(obj.UiPlotArea));
0724             obj.UiPlotArea = gui.util.uicontainer(<span class="string">'parent'</span>, obj.UiMainContainer, <span class="keyword">...</span><span class="comment">                </span>
0725                 <span class="string">'units'</span>, <span class="string">'pixels'</span>, <span class="keyword">...</span>
0726                 <span class="string">'backgroundcolor'</span>, obj.BackgroundColor, <span class="keyword">...</span>
0727                 <span class="string">'tag'</span>, <span class="string">'autogui-plotarea'</span>);
0728             drawnow;
0729             
0730             <span class="keyword">if</span> doResizeFigure
0731                 figpos = get(obj.UiHandle,<span class="string">'position'</span>);
0732                 figpos(3) = figpos(3) + obj.DefaultPlotAreaWidth;
0733                 set(obj.UiHandle,<span class="string">'position'</span>,figpos);
0734             <span class="keyword">end</span>
0735             
0736             set(obj.UiHandle, <span class="string">'menubar'</span>, <span class="string">'none'</span>, <span class="keyword">...</span><span class="comment">   %STD changed menubar to 'none'                </span>
0737                 <span class="string">'Toolbar'</span>, <span class="string">'figure'</span>,<span class="keyword">...</span><span class="comment">                %STD added 'Toolbar'</span>
0738                 <span class="string">'HandleVisibility'</span>, <span class="string">'on'</span>, <span class="keyword">...</span>
0739                 <span class="string">'resize'</span>, <span class="string">'on'</span>, <span class="keyword">...</span>
0740                 <span class="string">'units'</span>, <span class="string">'pixels'</span>, <span class="keyword">...</span>
0741                 <span class="string">'numbertitle'</span>, <span class="string">'off'</span>);   
0742             
0743             <span class="comment">%STD; delete Standard GUI menus here</span>
0744            <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(findall(obj.UiHandle,<span class="string">'tag'</span>,<span class="string">'Standard.SaveFigure'</span>));  <span class="comment">%Save button</span>
0745            <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(findall(obj.UiHandle,<span class="string">'tag'</span>,<span class="string">'Standard.NewFigure'</span>)); <span class="comment">% New Figure button</span>
0746            <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(findall(obj.UiHandle,<span class="string">'tag'</span>,<span class="string">'Standard.FileOpen'</span>)); <span class="comment">% Open File button</span>
0747            <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(findall(obj.UiHandle,<span class="string">'tag'</span>,<span class="string">'Standard.PrintFigure'</span>)); <span class="comment">%Print button</span>
0748            <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(findall(obj.UiHandle,<span class="string">'tag'</span>,<span class="string">'Exploration.Rotate'</span>)); <span class="comment">%Rotate 3D</span>
0749            <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(findall(obj.UiHandle,<span class="string">'tag'</span>,<span class="string">'Exploration.Brushing'</span>)); <span class="comment">%Brush</span>
0750            <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(findall(obj.UiHandle,<span class="string">'tag'</span>,<span class="string">'DataManager.Linking'</span>)); <span class="comment">%Link</span>
0751            <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(findall(obj.UiHandle,<span class="string">'tag'</span>,<span class="string">'Annotation.InsertColorbar'</span>)); <span class="comment">%Colarbar</span>
0752            <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(findall(obj.UiHandle,<span class="string">'tag'</span>,<span class="string">'Plottools.PlottoolsOn'</span>)); <span class="comment">%Plot tools1</span>
0753            <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(findall(obj.UiHandle,<span class="string">'tag'</span>,<span class="string">'Plottools.PlottoolsOff'</span>)); <span class="comment">%Plot tools2</span>
0754            set(findall(obj.UiHandle,<span class="string">'tag'</span>,<span class="string">'Standard.EditPlot'</span>),<span class="string">'Separator'</span>, <span class="string">'off'</span>);
0755            
0756    <span class="comment">%Future versions of GUI toolbar tags may have their nameschanged;</span>
0757    <span class="comment">%use  hToolbar = findall(gcf,'tag','FigureToolBar');get(findall(hToolbar),'tag');</span>
0758     
0759            
0760             <span class="keyword">if</span> strcmp(newLocation, <span class="string">'right'</span>)
0761                 set(obj.UiMainContainer, <span class="string">'flowdirection'</span>, <span class="string">'righttoleft'</span>);
0762             <span class="keyword">elseif</span> strcmp(newLocation, <span class="string">'left'</span>)
0763                 set(obj.UiMainContainer, <span class="string">'flowdirection'</span>, <span class="string">'lefttoright'</span>);
0764             <span class="keyword">end</span>            
0765             
0766             axes(<span class="string">'parent'</span>,obj.UiHandle);
0767         <span class="keyword">end</span>
0768         
0769        
0770         <span class="comment">% does not update obj.Location</span>
0771         <a name="_sub32" href="#_subfunctions" class="code">function deletePlotArea(obj)        </a>
0772             <span class="comment">% delete the plotArea &amp; resize the figure to be just</span>
0773             <span class="comment">% the size of hGuiAreaFrame</span>
0774             assert(~isempty(obj.UiPlotArea));
0775             <a href="#_sub2" class="code" title="subfunction delete(obj)">delete</a>(obj.UiPlotArea);
0776             obj.UiPlotArea = [];
0777             drawnow;                        
0778             
0779             figpos = get(obj.UiHandle, <span class="string">'position'</span>);
0780             guiwidth = get(obj.UiGuiArea, <span class="string">'widthlimits'</span>);
0781             guiheight = get(obj.UiGuiArea, <span class="string">'heightlimits'</span>);
0782             newpos = [figpos(1:2) guiwidth(1)+5 guiheight(1)+5];
0783             set(obj.UiHandle, <span class="string">'Position'</span>, newpos);
0784             
0785             set(obj.UiHandle, <span class="string">'menubar'</span>, <span class="string">'none'</span>, <span class="keyword">...</span>
0786                 <span class="string">'HandleVisibility'</span>, <span class="string">'on'</span>, <span class="keyword">...</span>
0787                 <span class="string">'resize'</span>, <span class="string">'off'</span>, <span class="keyword">...</span>
0788                 <span class="string">'units'</span>, <span class="string">'pixels'</span>, <span class="keyword">...</span>
0789                 <span class="string">'numbertitle'</span>, <span class="string">'off'</span>);
0790             
0791         <span class="keyword">end</span>       
0792        
0793        
0794         <a name="_sub33" href="#_subfunctions" class="code">function changeGuiAreaWidth(obj, delta)                </a>
0795             figpos = get(obj.UiHandle, <span class="string">'position'</span>);
0796             guiwidth = get(obj.UiGuiArea, <span class="string">'widthlimits'</span>);
0797             
0798             guiwidth = guiwidth + delta;            
0799             <span class="keyword">if</span> strcmp(obj.Location, <span class="string">'float'</span>)
0800                 figpos(3) = guiwidth(1);                
0801             <span class="keyword">else</span>
0802                 figpos(3) = figpos(3) + delta;
0803             <span class="keyword">end</span>
0804             set(obj.UiGuiArea, <span class="string">'widthlimits'</span>, guiwidth);
0805             set(obj.UiHandle, <span class="string">'position'</span>, figpos);
0806         <span class="keyword">end</span>
0807         
0808         <span class="comment">% check if child's width has changed. if yes, see if</span>
0809         <span class="comment">% panel width needs to be updated.</span>
0810         <a name="_sub34" href="#_subfunctions" class="code">function checkChildWidth(obj, child, index)</a>
0811             <span class="comment">% child is assumed to be visible</span>
0812             <span class="comment">% and widget already in the container</span>
0813             <span class="comment">% assert is not JIT-ed</span>
0814             <span class="comment">% assert(~isnan(obj.ChildList(index).storedWidth));</span>
0815             newwidth = child.getPositionWidth();
0816             <span class="keyword">if</span> newwidth &gt; obj.PanelWidth
0817                 <span class="comment">% try to stretch the panel</span>
0818                 obj.PanelWidth = newwidth;
0819             <span class="keyword">else</span> <span class="comment">% newwidth &lt;= obj.PanelWidth</span>
0820                 <span class="comment">% nothing to do</span>
0821                 obj.ChildList(index).storedWidth = newwidth;
0822             <span class="keyword">end</span>
0823         <span class="keyword">end</span>
0824         
0825         
0826         <a name="_sub35" href="#_subfunctions" class="code">function updatePanelHeight(obj, child, index, forceRecompute)</a>
0827             <span class="keyword">if</span> obj.ChildList(index).panel ~= obj.CurrentPanelNum               
0828                 <span class="keyword">return</span>;  <span class="comment">% we don't handle recomputes for old panels</span>
0829             <span class="keyword">end</span>            
0830             newHeight = child.getPositionHeight();
0831             <span class="keyword">if</span> (newHeight == obj.ChildList(index).storedHeight) &amp;&amp; ~forceRecompute                
0832                 <span class="keyword">return</span>; <span class="comment">% nothing to change</span>
0833             <span class="keyword">end</span>
0834             
0835             <span class="comment">% recalculate height of current panel</span>
0836             obj.ChildList(index).storedHeight = newHeight;
0837             indices = obj.findChildrenInPanel();
0838             totalHeight = sum([obj.ChildList(indices).storedHeight]) + (4*numel(indices));            
0839             totalHeight = totalHeight + 10; 
0840 
0841             <span class="comment">% check if we need to grow the GuiArea</span>
0842             <span class="keyword">if</span> totalHeight &gt; obj.MinimumGuiPanelHeight                                             
0843                 set(obj.UiGuiArea, <span class="string">'HeightLimits'</span>, totalHeight + [0 0]);
0844                 obj.MinimumGuiPanelHeight = totalHeight;     
0845                 
0846                 <span class="comment">% check if we need to grow the figure as well</span>
0847                 pos = obj.Position;
0848                 <span class="keyword">if</span> totalHeight &gt; pos.height
0849                     <span class="comment">% grow downward</span>
0850                     increment = totalHeight - pos.height;
0851                     obj.Position = struct(<span class="string">'y'</span>, pos.y-increment, <span class="string">'height'</span>, totalHeight);
0852                 <span class="keyword">end</span>
0853 
0854                 refresh(obj.UiHandle);
0855             <span class="keyword">end</span>
0856         <span class="keyword">end</span>
0857         
0858         
0859        <span class="comment">% The main invariant: the panel should be at least as wide</span>
0860        <span class="comment">% as the widest child.</span>
0861        <a name="_sub36" href="#_subfunctions" class="code">function finalwidth = updatePanelWidth(obj, oldwidth, newwidth)</a>
0862            <span class="comment">% note: newwidth hasn't been committed to obj.PanelWidth yet</span>
0863            indices = obj.findChildrenInPanel();
0864            <span class="keyword">if</span> (newwidth &gt;= oldwidth) || isempty(indices) 
0865                <span class="comment">% no extra work to be done.</span>
0866                finalwidth = newwidth;
0867            <span class="keyword">else</span> 
0868                <span class="comment">% shrink child widgets if possible</span>
0869                tmpWidthList = zeros(size(obj.ChildList));
0870                <span class="keyword">for</span> i=indices
0871                    child = obj.ChildList(i).widget;
0872                    <span class="keyword">if</span> obj.ChildList(i).storedWidth &gt; newwidth                       
0873                        child.setPositionWidth(newwidth);
0874                        newChildWidth = child.getPositionWidth();
0875                        obj.ChildList(i).storedWidth = newChildWidth;
0876                        tmpWidthList(i) = newChildWidth;
0877                    <span class="keyword">end</span>                   
0878                <span class="keyword">end</span>
0879                <span class="comment">% some child widgets may not be able to shrink as requested</span>
0880                <span class="comment">% ensure that panel is wider than these</span>
0881                maxWidgetWidth = max(tmpWidthList);
0882                finalwidth = max(maxWidgetWidth, newwidth);
0883            <span class="keyword">end</span>
0884 
0885        <span class="keyword">end</span>
0886         
0887    <span class="keyword">end</span>
0888    
0889    
0890    methods(Static)
0891         <a name="_sub37" href="#_subfunctions" class="code">function obj = getCurrentInstance()</a>
0892             <span class="comment">% getCurrentInstance</span>
0893             <span class="comment">%</span>
0894             <span class="comment">%  obj = gui.autogui.getCurrentInstance() returns the</span>
0895             <span class="comment">%  most-recent instance of gui.autogui. If there is</span>
0896             <span class="comment">%  no such instance, obj is [].</span>
0897             
0898             <span class="comment">% fig is the list of figures (the current figure is always</span>
0899             <span class="comment">% first in the list). Note that findall works even if</span>
0900             <span class="comment">% HandleVisibility is 'off'</span>
0901             fig = findall(0,  <span class="string">'-depth'</span>, 1, <span class="string">'type'</span>, <span class="string">'figure'</span>, <span class="string">'tag'</span>, <span class="string">'EasyGUIContainer'</span>);                        
0902             obj = [];                        
0903             <span class="keyword">for</span> i=1:length(fig)
0904                 <span class="keyword">if</span> isa(get(fig(i),<span class="string">'userdata'</span>) , <span class="string">'gui.autogui'</span>)
0905                     obj = get(fig(i),<span class="string">'userdata'</span>);
0906                     <span class="keyword">break</span>;
0907                 <span class="keyword">end</span>                
0908             <span class="keyword">end</span>            
0909         <span class="keyword">end</span> 
0910         
0911     <span class="keyword">end</span>
0912 
0913     
0914 <span class="keyword">end</span>
0915 
0916</pre></div>
<hr><address>Generated on Thu 07-Aug-2014 13:40:59 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>